
{% assign config       = include.content.config %}
{% assign items        = include.content.items %}
{% assign row-gutter   = "30" %}
{% assign height       = "250" %}

{% if config.row-gutter %}
  {% assign row-gutter = config.row-gutter %}
{% endif %}



{% for item in items %}
  {% assign link = link %}

  <table {{table.inner}}>
    <tr>
      <td bgcolor="{{color.background.box}}" style="{{rounded.md}} {{depth.default}}">

        <table {{table.default}} class="responsive-table-lg" align="left" width="{{width}}">
          <tr>
            <!-- background image has to be the same height of the email with fallback typefaces for consistent rending in outlook -->
            <td bgcolor="{{color.black}}" background="{{item.image}}" style="background-position: top center; background-repeat: no-repeat; background-size: cover; border-top-left-radius: 3px; border-bottom-left-radius: 3px;">
              <!--[if (gt mso 9)&(lt mso 16)]>
              <v:rect xmlns:v="urn:schemas-microsoft-com:vml" fill="true" stroke="false" style="mso-width-percent:1000;">
                <v:fill type="frame" src="{{item.image}}" color="{{color.black}}" />
                <v:textbox style="mso-fit-shape-to-text:true" inset="0,0,0,0">
              <![endif]-->

              <!-- center table - alignment is lost when the above vml hack is applied, need an extra table to center the content -->
              <table {{table.fluid}} height="{{height}}">
                <tr>
                  <td align="center">
                    <!-- Top -->
                    <table {{table.fluid}} height="45">
                      <tr>
                        <td valign="top" style="{{spacing.hpad.sm}} padding-top: {{spacing.sm}};">
                          <table {{table.fluid}}>
                            <tr>
                              <td align="left" class="text-md" style="{{text.md}} {{typography.bold}} color: {{color.white}};">
                                Sale ends {{item.expires | date: "%B %d"}}
                              </td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                    </table>
                    <!-- Link -->
                    <table class="offer__image" {{table.fluid}} height="{% if item.attribute %}{{height | minus: 45 | minus: 45}}{% else %}{{height | minus: 45}}{% endif %}">
                      <tr>
                        <td>
                          <a href="{{link}}" style="height: 100%; width: 100%; display: block;"></a>
                        </td>
                      </tr>
                    </table>
                    {% if item.attribute %}
                    <!-- Bottom -->
                    <table {{table.fluid}} height="45">
                      <tr>
                        <td valign="bottom" style="{{spacing.hpad.sm}} padding-bottom: {{spacing.sm}};">
                          {% include element/badge.html label=item.attribute %}
                        </td>
                      </tr>
                    </table>
                    {% endif %}
                  </td>
                </tr>
              </table>

              <!--[if (gt mso 9)&(lt mso 16)]>
                </v:textbox>
              </v:rect>
              <![endif]-->
            </td>
          </tr>
        </table>

        <table {{table.default}} class="responsive-table-lg" align="right" width="{{width}}">
          <tr>
            <td style="{{spacing.hpad.sm}}" height="{{height}}" valign="middle" class="responsive-td-lg">
              <table {{table.fluid}}>
                <!-- Location -->
                <tr>
                  <td align="left" style="padding-bottom: 8px;">
                    <table {{table.default}} align="left">
                      <tr>
                        <td align="left" valign="middle" style="padding-right: 8px">
                          <img src="img/se20..location.png" width="11">
                        </td>
                        <td align="left" valign="middle" class="text-md" style="{{text.md}} color: {{color.grey.dark}}; padding-bottom: 0;">
                          {{item.location}}
                        </td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
              <!-- Title -->
              {% include element/title.html title=item.title align="left" style="md" %}
              {% include element/space.html height="15" %}
              <!-- Price -->
              <table {{table.fluid}}>
                <tr>
                  <td align="left" class="text-md" style="{{text.md}} color: {{color.grey.dark}};">
                    {{locale.offer.from}} <span style="font-weight: 700; font-size: 20px; color: {{color.primary.default}};">{{locale.offer.currency}}{{item.price}}</span> {{item.price-description}}
                  </td>
                </tr>
              </table>
              <!-- CTA -->
              <table {{table.fluid}}>
                <tr>
                  <td align="left" style="padding-top: 8px;">
                    {% include element/button.html link=link label=locale.offer.cta align="left" %}
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>

      </td>
    </tr>
  </table>
  {% include element/space.html height=row-gutter %}

{% endfor %}
